var getBlockquoteType=function(e){return(" "+e.className+" ").replace(/[\n\t]/g," ").indexOf(" blockquote-s01 ")>-1?"blockquote-s01":(" "+e.className+" ").replace(/[\n\t]/g," ").indexOf(" blockquote-s02 ")>-1?"blockquote-s02":(" "+e.className+" ").replace(/[\n\t]/g," ").indexOf(" blockquote-s03 ")>-1?"blockquote-s03":"blockquote"};tinymce.PluginManager.add("blockquoteListBox",function(e){var t=null;e.on("init",function(){e.formatter.register("blockquotestyle",{block:"blockquote",attributes:{"class":"%value"},wrapper:1}),e.formatter.register("changeblockquotestyle",{block:"blockquote",attributes:{"class":"%value"},wrapper:0,remove:"all"})}),e.addCommand("blockquotechange",function(o,c){var n=tinymce.activeEditor.selection.getBookmark();"cancel"==c&&(t||(c="blockquote-s01")),c==t&&(c="cancel"),"cancel"==c?e.formatter.remove("changeblockquotestyle"):t?e.formatter.apply("changeblockquotestyle",{value:c,wrapper:1}):e.formatter.apply("blockquotestyle",{value:c,wrapper:1}),tinymce.activeEditor.selection.moveToBookmark(n)});var o,c=function(o){var c=null;c=e.selection.getNode().nodeName=="BLOCKQUOTE"?ed.selection.getNode():e.dom.getParent(e.selection.getNode(),"blockquote"),t=c?getBlockquoteType(c):null,o&&o.control.items().each(function(e){e.active(e.settings.data===t)})};o=[{text:"样式一",data:"blockquote-s01"},{text:"样式二",data:"blockquote-s02"},{text:"样式三",data:"blockquote-s03"}],e.addButton("blockquoteListBox",{icon:"blockquote",type:"splitbutton",tooltip:"设置引用样式",menu:o,onshow:c,onselect:function(t){e.execCommand("blockquotechange",!1,t.control.settings.data)},onclick:function(){c(),e.execCommand("blockquotechange",!1,"cancel")},onPostRender:function(){var t=this;e.on("NodeChange",function(o){t.active(o.element.nodeName=="BLOCKQUOTE"||e.dom.getParent(o.element,"blockquote"))})}})});